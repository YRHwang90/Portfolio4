"0",""
"0","gen_data_sim <- function( cn, cs, gam, G, sigma2=1){"
"0",""
"0","  xp<-cbind(1,seq_len(cs) -1) # why -1?"
"0","  x <- xp[rep(seq_len(cs), cn), ]"
"0","# id generation"
"0","  cn_id<-seq_len(cn)"
"0","  pid<-rep(cn_id, each=cs)"
"0","  "
"0","# random componets "
"0","  uj<-rmnorm(cn,mean=rep(0,2), varcov=G)"
"0","  eij<-rnorm(cn*cs,sd=sqrt(sigma2))"
"0",""
"0","## compute beta"
"0","  betaj<-matrix(gam,nrow=cn,ncol=2,byrow=T)+uj"
"0",""
"0","## Compute DV"
"0","  y<-rowSums(x*betaj[pid,])+eij"
"0",""
"0","## combine that into dataframe"
"0","  sim_dat1<-tibble(y,time = x[,2],pid)"
"0",""
"0","## return data"
"0","  return(sim_dat1)"
"0","}"
